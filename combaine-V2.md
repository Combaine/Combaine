# Combaine-V2

Ввиду того, что многие положенные в основу концепции не прошли испытание временем, а структруа становиться все хуже, то
кажется необходимым пересмотреть архитектуру с учетом полученного за время эксплуатации опыта. Так как обновилась платформа,
лежащая в ядре системы, то настало самое время, чтобы сделать это. Попробую здесь исложиться некоторые концептуальные решения, дабы не плодить
хаос.

##  Combainer:
	* на основе tornado + cocaine-framework-python
	* можно сделать ручки аля  info  и пинг
	* асинхронный zookeeper, лок проверять, как в  zkflock. то есть через  condition(low_timeout)
	* логи, через систему логирования
	* конфиги перечитывать ТОЛЬКО по сигналу (SIGHUP, http-api etc)
	* кажется консистентность внутри сессии обеспечить сейчас нет необходимости, заменим на дамб сторадж


## Combainerd:
	* вотчиться кокаиновым приложением, по таймеру
	* демон, спавнящий combainerов
	* слушает  UDS  и TCP  наружу
	* агрегирует инфу от комбайнеров (конфиги и занятые порты)

## Common services
	* hostfetcher

## Misc:
	*  разработка общих компонентов (логеры, валидаторы конфигов!!!, и подобное)
	*  минимальная временная единица - длина сессии (никак внутри не дробится)